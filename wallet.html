<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© - Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .balance-hero {
            background: linear-gradient(135deg, #1e293b, #0f172a);
            padding: 50px;
            border-radius: 40px;
            color: white;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .balance-hero::after {
            content: "â­ï¸";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 150px;
            opacity: 0.05;
        }

        .transaction-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8fafc;
            border-radius: 20px;
            margin-bottom: 10px;
            border: 1px solid rgba(0, 0, 0, 0.02);
        }
    </style>
</head>

<body>

    <nav class="glass-nav">
        <a href="index.html" class="logo-container">
            <div class="logo-box">Ø¨</div>
            <div style="font-weight: 900; font-size: 18px;">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</div>
        </a>
        <div class="nav-links" id="nav-menu">
            <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            <a href="doctors.html">Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</a>
            <a href="taxi.html">Ø§Ù„Ù†Ù‚Ù„</a>
            <a href="wallet.html" class="active">Ø§Ù„Ù…Ø­ÙØ¸Ø©</a>
        </div>
        <div id="nav-right" style="display: flex; align-items: center; gap: 15px;"></div>
        <div class="menu-toggle" id="mobile-toggle">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </nav>

    <div class="container" style="max-width: 900px; padding-top: 40px;">
        <div class="balance-hero">
            <p style="font-weight: 800; font-size: 1rem; opacity: 0.8; margin-bottom: 15px;">Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ù„ÙƒÙŠØ©</p>
            <h1 id="wallet-balance"
                style="font-size: 4.5rem; font-weight: 950; margin-bottom: 25px; color: var(--gold);">0</h1>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button id="topup-btn" onclick="topUp()" class="btn btn-primary"
                    style="display: none; padding: 15px 40px; border-radius: 20px;">Ø´Ø­Ù† Ù†Ù‚Ø§Ø·</button>
                <button class="btn"
                    style="background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2);">Ø³Ø­Ø¨
                    Ø£Ù…ÙˆØ§Ù„</button>
                <button class="btn"
                    style="background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2);">ØªØ­ÙˆÙŠÙ„
                    Ù†Ù‚Ø§Ø·</button>
            </div>
        </div>

        <div class="grid grid-2">
            <div class="card">
                <h3 style="font-weight: 900; margin-bottom: 25px;">Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù†Ù‚Ø§Ø·</h3>
                <div class="grid grid-2" style="gap: 15px;">
                    <div
                        style="text-align: center; padding: 20px; background: #f0fdf4; border-radius: 20px; border: 1px solid #dcfce7;">
                        <p style="font-size: 0.7rem; font-weight: 800; color: #16a34a; margin-bottom: 5px;">Ù‚ÙŠÙ…Ø© Ø§Ù„Ù†Ù‚Ø·Ø©
                        </p>
                        <h4 style="font-weight: 900;">1,000 Ù„.Ø³</h4>
                    </div>
                    <div
                        style="text-align: center; padding: 20px; background: #eff6ff; border-radius: 20px; border: 1px solid #dbeafe;">
                        <p style="font-size: 0.7rem; font-weight: 800; color: #2563eb; margin-bottom: 5px;">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰
                        </p>
                        <h4 style="font-weight: 900;">10 Ù†Ù‚Ø§Ø·</h4>
                    </div>
                </div>
                <div
                    style="margin-top: 25px; padding: 15px; background: #F8FAFC; border-radius: 15px; font-size: 0.8rem; font-weight: 700; color: #64748B;">
                    ğŸ’¡ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ù‚Ø§Ø· Ù„Ø¯ÙØ¹ ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ØŒ Ø±Ø­Ù„Ø§Øª Ø§Ù„ØªØ§ÙƒØ³ÙŠØŒ Ø£Ùˆ Ø­ØªÙ‰ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ù†Ù‚Ø¯Ø§Ù‹ Ø¹Ø¨Ø± Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡
                    Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ÙŠÙ†.
                </div>
            </div>

            <div class="card">
                <h3 style="font-weight: 900; margin-bottom: 25px;">Ø³Ø¬Ù„ Ø§Ù„Ù†Ù‚Ø§Ø·</h3>
                <div id="tx-content">
                    <!-- Dynamic Transactions -->
                </div>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script>
        function renderWallet() {
            if (!Store.user) return;
            document.getElementById('wallet-balance').innerText = Store.user.balance.toLocaleString();

            // Show Top Up button only for Agents and Admins
            if (Store.user.role === 'ADMIN' || Store.user.role === 'AGENT') {
                document.getElementById('topup-btn').style.display = 'block';
            }

            const txs = Store.getData('transactions');
            const container = document.getElementById('tx-content');

            if (txs.length === 0) {
                container.innerHTML = `<div style="text-align: center; padding: 40px 0; opacity: 0.4;">
                                        <p style="font-weight: 800;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ù†Ù‚Ø§Ø· Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                                      </div>`;
            } else {
                container.innerHTML = '';
                txs.forEach(tx => {
                    const isDebit = tx.amount > 0;
                    container.innerHTML += `
                        <div class="transaction-card">
                            <div>
                                <p style="font-weight: 900; font-size: 0.85rem;">${tx.title}</p>
                                <p style="font-size: 0.7rem; color: #64748B; font-weight: 700;">${tx.date}</p>
                            </div>
                            <p style="font-weight: 950; color: ${isDebit ? '#dc2626' : '#16a34a'};">
                                ${isDebit ? '-' : '+'}${Math.abs(tx.amount)}
                            </p>
                        </div>
                    `;
                });
            }
        }

        function topUp() {
            if (Store.user.role !== 'ADMIN' && Store.user.role !== 'AGENT') {
                alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø´Ø­Ù† Ø§Ù„Ø±ØµÙŠØ¯ ÙŠØªÙ… ÙÙ‚Ø· Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ÙŠÙ†. ÙŠØ±Ø¬Ù‰ Ø²ÙŠØ§Ø±Ø© Ø£Ù‚Ø±Ø¨ ÙˆÙƒÙŠÙ„ Ù„Ø´Ø­Ù† Ø­Ø³Ø§Ø¨Ùƒ.");
                return;
            }
            const amount = prompt("Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ø´Ø­Ù†Ù‡Ø§ (Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† ÙÙ‚Ø·):", "100");
            if (amount && !isNaN(amount)) {
                Store.updateUserBalance(Store.user.phone, parseInt(amount), "Ø´Ø­Ù† Ù…Ø¨Ø§Ø´Ø± (Ø¥Ø¯Ø§Ø±Ø©)", Store.user.role);
                renderWallet();
                UI.updateNavbar();
            }
        }

        document.addEventListener('DOMContentLoaded', renderWallet);
    </script>
</body>

</html>